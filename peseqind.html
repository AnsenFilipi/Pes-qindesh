<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peseqind - Albanian Card Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 1200px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #1e3c72;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-style: italic;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
        }

        .info-box {
            text-align: center;
        }

        .info-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #1e3c72;
        }

        .play-area {
            background: #2d5016;
            border-radius: 15px;
            padding: 40px 20px;
            margin-bottom: 30px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .trick-cards {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .played-card {
            position: relative;
        }

        .player-label {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 0.8em;
            white-space: nowrap;
        }

        .card {
            width: 80px;
            height: 112px;
            background: white;
            border: 2px solid #333;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .card.hearts, .card.diamonds {
            color: #d32f2f;
        }

        .card.clubs, .card.spades {
            color: #212121;
        }

        .card-rank {
            font-size: 1.2em;
            font-weight: bold;
        }

        .card-suit {
            font-size: 1.5em;
            text-align: center;
        }

        .player-hand {
            margin-bottom: 20px;
        }

        .hand-label {
            text-align: center;
            margin-bottom: 10px;
            font-weight: bold;
            color: #1e3c72;
        }

        .hand-cards {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 30px;
            font-size: 1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: #1e3c72;
            color: white;
        }

        .btn-primary:hover {
            background: #2a5298;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 60, 114, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .scoreboard {
            margin-top: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
        }

        .scoreboard h3 {
            margin-bottom: 15px;
            color: #1e3c72;
        }

        .score-row {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin-bottom: 5px;
            background: white;
            border-radius: 5px;
        }

        .winner {
            background: #4caf50 !important;
            color: white;
        }

        .message {
            text-align: center;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            font-weight: bold;
        }

        .message.info {
            background: #e3f2fd;
            color: #1976d2;
        }

        .message.success {
            background: #e8f5e9;
            color: #388e3c;
        }

        .message.warning {
            background: #fff3e0;
            color: #f57c00;
        }

        .rules {
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
            font-size: 0.9em;
        }

        .rules h3 {
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .rules ul {
            margin-left: 20px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ðŸŽ´ Peseqind ðŸŽ´</h1>
        <p class="subtitle">Traditional Albanian Card Game</p>

        <div class="game-info">
            <div class="info-box">
                <div class="info-label">Round</div>
                <div class="info-value" id="round">1</div>
            </div>
            <div class="info-box">
                <div class="info-label">Trump Suit</div>
                <div class="info-value" id="trump">-</div>
            </div>
            <div class="info-box">
                <div class="info-label">Current Trick</div>
                <div class="info-value" id="trick">1</div>
            </div>
            <div class="info-box">
                <div class="info-label">Your Score</div>
                <div class="info-value" id="playerScore">0</div>
            </div>
        </div>

        <div id="message" class="message info" style="display:none;"></div>

        <div class="play-area">
            <div class="trick-cards" id="trickCards"></div>
        </div>

        <div class="player-hand">
            <div class="hand-label">Your Hand</div>
            <div class="hand-cards" id="playerHand"></div>
        </div>

        <div class="buttons">
            <button class="btn-primary" onclick="game.startNewGame()">New Game</button>
            <button class="btn-secondary" onclick="game.toggleRules()">Show Rules</button>
        </div>

        <div class="scoreboard">
            <h3>Scores</h3>
            <div id="scores"></div>
        </div>

        <div class="rules" id="rules" style="display:none;">
            <h3>How to Play Peseqind</h3>
            <ul>
                <li><strong>Goal:</strong> Be the first player to reach 500 points</li>
                <li><strong>Players:</strong> 4 players (you vs 3 AI opponents)</li>
                <li><strong>Trump:</strong> A trump suit is selected each round</li>
                <li><strong>Playing:</strong> Follow the lead suit if possible, otherwise play any card</li>
                <li><strong>Winning Tricks:</strong> Highest trump wins, or highest card of lead suit</li>
                <li><strong>Scoring:</strong>
                    <ul>
                        <li>Each trick won = 10 points</li>
                        <li>Aces = 11 points each</li>
                        <li>Tens = 10 points each</li>
                        <li>Kings = 4 points each</li>
                        <li>Queens = 3 points each</li>
                        <li>Jacks = 2 points each</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <script>
        class Card {
            constructor(suit, rank) {
                this.suit = suit;
                this.rank = rank;
            }

            getValue() {
                const values = {
                    'A': 11, '10': 10, 'K': 4, 'Q': 3, 'J': 2, '9': 0, '8': 0, '7': 0
                };
                return values[this.rank] || 0;
            }

            getRankValue() {
                const ranks = {
                    'A': 14, 'K': 13, 'Q': 12, 'J': 11, '10': 10, '9': 9, '8': 8, '7': 7
                };
                return ranks[this.rank];
            }

            toHTML() {
                const suits = {
                    'hearts': 'â™¥',
                    'diamonds': 'â™¦',
                    'clubs': 'â™£',
                    'spades': 'â™ '
                };
                return `
                    <div class="card ${this.suit}">
                        <div class="card-rank">${this.rank}</div>
                        <div class="card-suit">${suits[this.suit]}</div>
                        <div class="card-rank">${this.rank}</div>
                    </div>
                `;
            }
        }

        class Game {
            constructor() {
                this.players = ['You', 'Player 2', 'Player 3', 'Player 4'];
                this.scores = [0, 0, 0, 0];
                this.hands = [[], [], [], []];
                this.currentTrick = [];
                this.currentPlayer = 0;
                this.leadPlayer = 0;
                this.trump = null;
                this.round = 1;
                this.trickNumber = 1;
                this.trickWinners = [0, 0, 0, 0];
                this.startNewGame();
            }

            createDeck() {
                const suits = ['hearts', 'diamonds', 'clubs', 'spades'];
                const ranks = ['7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
                const deck = [];
                
                for (let suit of suits) {
                    for (let rank of ranks) {
                        deck.push(new Card(suit, rank));
                    }
                }
                
                return this.shuffle(deck);
            }

            shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            dealCards() {
                const deck = this.createDeck();
                this.hands = [[], [], [], []];
                
                for (let i = 0; i < deck.length; i++) {
                    this.hands[i % 4].push(deck[i]);
                }

                // Set trump suit (last card dealt to dealer)
                this.trump = this.hands[3][this.hands[3].length - 1].suit;
            }

            startNewGame() {
                this.scores = [0, 0, 0, 0];
                this.round = 1;
                this.startNewRound();
            }

            startNewRound() {
                this.dealCards();
                this.currentTrick = [];
                this.currentPlayer = this.leadPlayer;
                this.trickNumber = 1;
                this.trickWinners = [0, 0, 0, 0];
                this.updateDisplay();
                this.showMessage(`Round ${this.round} started! Trump suit is ${this.getTrumpSymbol()}`, 'info');
            }

            getTrumpSymbol() {
                const suits = {
                    'hearts': 'â™¥',
                    'diamonds': 'â™¦',
                    'clubs': 'â™£',
                    'spades': 'â™ '
                };
                return suits[this.trump];
            }

            playCard(playerIndex, cardIndex) {
                if (playerIndex !== 0 || this.currentPlayer !== 0) return;

                const card = this.hands[0][cardIndex];
                
                // Check if play is valid
                if (!this.isValidPlay(card, this.hands[0])) {
                    this.showMessage('You must follow suit if possible!', 'warning');
                    return;
                }

                this.hands[0].splice(cardIndex, 1);
                this.currentTrick.push({ player: 0, card: card });
                this.currentPlayer = 1;
                
                this.updateDisplay();
                
                // AI plays
                setTimeout(() => this.aiPlay(), 1000);
            }

            isValidPlay(card, hand) {
                if (this.currentTrick.length === 0) return true;
                
                const leadSuit = this.currentTrick[0].card.suit;
                const hasSuit = hand.some(c => c.suit === leadSuit);
                
                if (hasSuit && card.suit !== leadSuit) {
                    return false;
                }
                
                return true;
            }

            aiPlay() {
                if (this.currentPlayer >= 4) {
                    this.endTrick();
                    return;
                }

                const hand = this.hands[this.currentPlayer];
                let cardToPlay;

                if (this.currentTrick.length === 0) {
                    // Lead with highest card
                    cardToPlay = hand.reduce((max, card) => 
                        card.getRankValue() > max.getRankValue() ? card : max
                    );
                } else {
                    const leadSuit = this.currentTrick[0].card.suit;
                    const suitCards = hand.filter(c => c.suit === leadSuit);
                    
                    if (suitCards.length > 0) {
                        // Play lowest card of suit
                        cardToPlay = suitCards.reduce((min, card) => 
                            card.getRankValue() < min.getRankValue() ? card : min
                        );
                    } else {
                        // Play lowest card overall
                        cardToPlay = hand.reduce((min, card) => 
                            card.getRankValue() < min.getRankValue() ? card : min
                        );
                    }
                }

                const cardIndex = hand.indexOf(cardToPlay);
                hand.splice(cardIndex, 1);
                this.currentTrick.push({ player: this.currentPlayer, card: cardToPlay });
                this.currentPlayer++;

                this.updateDisplay();

                if (this.currentPlayer < 4) {
                    setTimeout(() => this.aiPlay(), 1000);
                } else {
                    setTimeout(() => this.endTrick(), 1500);
                }
            }

            endTrick() {
                const winner = this.getTrickWinner();
                this.trickWinners[winner]++;
                
                // Calculate points for this trick
                let trickPoints = 10; // Base points for winning trick
                for (let play of this.currentTrick) {
                    trickPoints += play.card.getValue();
                }
                
                this.scores[winner] += trickPoints;
                
                this.showMessage(
                    `${this.players[winner]} wins the trick! (+${trickPoints} points)`,
                    'success'
                );

                this.currentTrick = [];
                this.currentPlayer = winner;
                this.leadPlayer = winner;
                this.trickNumber++;

                if (this.hands[0].length === 0) {
                    setTimeout(() => this.endRound(), 2000);
                } else {
                    setTimeout(() => {
                        this.updateDisplay();
                        if (this.currentPlayer !== 0) {
                            this.aiPlay();
                        }
                    }, 2000);
                }
            }

            getTrickWinner() {
                let winner = this.currentTrick[0];
                const leadSuit = winner.card.suit;

                for (let i = 1; i < this.currentTrick.length; i++) {
                    const current = this.currentTrick[i];
                    
                    // Trump beats non-trump
                    if (current.card.suit === this.trump && winner.card.suit !== this.trump) {
                        winner = current;
                    }
                    // Higher trump beats lower trump
                    else if (current.card.suit === this.trump && winner.card.suit === this.trump) {
                        if (current.card.getRankValue() > winner.card.getRankValue()) {
                            winner = current;
                        }
                    }
                    // Higher card of lead suit
                    else if (current.card.suit === leadSuit && winner.card.suit === leadSuit) {
                        if (current.card.getRankValue() > winner.card.getRankValue()) {
                            winner = current;
                        }
                    }
                }

                return winner.player;
            }

            endRound() {
                this.round++;
                
                // Check if anyone won
                const maxScore = Math.max(...this.scores);
                if (maxScore >= 500) {
                    const winnerIndex = this.scores.indexOf(maxScore);
                    this.showMessage(
                        `ðŸŽ‰ ${this.players[winnerIndex]} wins the game with ${maxScore} points! ðŸŽ‰`,
                        'success'
                    );
                    this.updateDisplay();
                    return;
                }

                this.showMessage(`Round ${this.round - 1} complete! Starting next round...`, 'info');
                setTimeout(() => this.startNewRound(), 3000);
            }

            updateDisplay() {
                // Update info
                document.getElementById('round').textContent = this.round;
                document.getElementById('trump').textContent = this.getTrumpSymbol();
                document.getElementById('trick').textContent = this.trickNumber;
                document.getElementById('playerScore').textContent = this.scores[0];

                // Update player hand
                const handDiv = document.getElementById('playerHand');
                handDiv.innerHTML = '';
                this.hands[0].forEach((card, index) => {
                    const cardDiv = document.createElement('div');
                    cardDiv.innerHTML = card.toHTML();
                    cardDiv.firstElementChild.onclick = () => this.playCard(0, index);
                    handDiv.appendChild(cardDiv.firstElementChild);
                });

                // Update trick cards
                const trickDiv = document.getElementById('trickCards');
                trickDiv.innerHTML = '';
                this.currentTrick.forEach(play => {
                    const cardContainer = document.createElement('div');
                    cardContainer.className = 'played-card';
                    cardContainer.innerHTML = `
                        <div class="player-label">${this.players[play.player]}</div>
                        ${play.card.toHTML()}
                    `;
                    trickDiv.appendChild(cardContainer);
                });

                // Update scores
                const scoresDiv = document.getElementById('scores');
                scoresDiv.innerHTML = '';
                this.players.forEach((player, i) => {
                    const scoreRow = document.createElement('div');
                    scoreRow.className = 'score-row';
                    if (this.scores[i] >= 500) {
                        scoreRow.classList.add('winner');
                    }
                    scoreRow.innerHTML = `
                        <span>${player}</span>
                        <span>${this.scores[i]} points (${this.trickWinners[i]} tricks)</span>
                    `;
                    scoresDiv.appendChild(scoreRow);
                });
            }

            showMessage(text, type = 'info') {
                const msgDiv = document.getElementById('message');
                msgDiv.textContent = text;
                msgDiv.className = `message ${type}`;
                msgDiv.style.display = 'block';
            }

            toggleRules() {
                const rules = document.getElementById('rules');
                rules.style.display = rules.style.display === 'none' ? 'block' : 'none';
            }
        }

        // Initialize game
        const game = new Game();
    </script>
</body>
</html>
